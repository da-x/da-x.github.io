<!DOCTYPE html>
<html lang="en-US">
<head>


 <!-- Global site tag (gtag.js) - Google Analytics -->
 <script async src="https://www.googletagmanager.com/gtag/js?id=UA-35403825-1"></script>
 <script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments);}
   gtag('js', new Date());

    gtag('config', 'UA-35403825-1');
 </script>


<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" as="font" href="https://blog.aloni.org/fonts/vendor/jost/jost-v4-latin-regular.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://blog.aloni.org/fonts/vendor/jost/jost-v4-latin-700.woff2"  type="font/woff2" crossorigin>


<link rel="stylesheet" href="https://blog.aloni.org/main.css">



  
  
  
  
  
    
  

  
  
    
    
  
  
  
    
  
  
  
  
    
  
  
  


  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">


	


	

<title>Back Propagation with TensorFlow | Dan Aloni</title>
<meta name="description" content="Dan Aloni">
<link rel="canonical" href="https://blog.aloni.org/posts/backprop-with-tensorflow/">










<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    
      
      
        
        
        
        
        
        
        
        
          {
            "@type": "ListItem",
            "position":  1 ,
            "name": "Home",
            "item": "https://blog.aloni.org/"
          },
          
          
          {
            "@type": "ListItem",
            "position":  2 ,
            "name": "Posts",
            "item": "https://blog.aloni.org/posts/"
          },
        
      
        
        
        
        
        
        
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  3 ,
            "name": "Backprop With Tensorflow",
            "item": "https://blog.aloni.org/posts/backprop-with-tensorflow/"
          },
        
      
    
  }
</script>





  <meta name="theme-color" content="#fff">
  <link rel="apple-touch-icon" sizes="180x180" href="https://blog.aloni.org/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://blog.aloni.org/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://blog.aloni.org/favicon-16x16.png">
  
    <link rel="manifest" href="https://blog.aloni.org/site.webmanifest">
  


  
    
      <!-- KaTeX -->
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
      <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
      <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
    
  

</head>

  


<body class="blog single">
  
  
<div class="header-bar fixed-top"></div>
<header class="navbar fixed-top navbar-expand-md navbar-light">
	<div class="container">
		<input class="menu-btn order-0" type="checkbox" id="menu-btn">
		<label class="menu-icon d-md-none" for="menu-btn"><span class="navicon"></span></label>
		<a class="navbar-brand order-1 order-md-0 me-auto" href="https://blog.aloni.org">Dan Aloni</a>
		<button id="mode" class="btn btn-link order-2 order-md-4" type="button" aria-label="Toggle mode">
			<span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span>
			<span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></span>
		</button>
		<button id="code-mode" class="btn btn-link order-2 order-md-4" type="button" aria-label="Toggle mode">
			<span class="code-toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="26" height="30" viewBox="-2 0 28 36" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
			    <text x="-2" y="34" font-size="10" stroke-width="1" font-family="Jose" font-weight="100">CODE</text>
  		        </svg></span>
			<span class="code-toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="26" height="30" viewBox="-2 0 28 36" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
			    <text x="-2" y="34" font-size="10" stroke-width="1" font-family="Jose" font-weight="100">CODE</text>
			</svg></span>
		</button>
		<ul class="navbar-nav fork-me order-3 order-md-5">
			
				
					<li class="nav-item">
						<a class="nav-link" href="/atom.xml"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-rss" viewBox="0 0 16 16"> <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/> <path d="M5.5 12a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm-3-8.5a1 1 0 0 1 1-1c5.523 0 10 4.477 10 10a1 1 0 1 1-2 0 8 8 0 0 0-8-8 1 1 0 0 1-1-1zm0 4a1 1 0 0 1 1-1 6 6 0 0 1 6 6 1 1 0 1 1-2 0 4 4 0 0 0-4-4 1 1 0 0 1-1-1z"/> </svg><span class="ms-2 visually-hidden">RSS</span></a>
					</li>
				
					<li class="nav-item">
						<a class="nav-link" href="https://twitter.com/DanAloni"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg><span class="ms-2 visually-hidden">Twitter</span></a>
					</li>
				
					<li class="nav-item">
						<a class="nav-link" href="https://github.com/da-x"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg><span class="ms-2 visually-hidden">GitHub</span></a>
					</li>
				
			
		</ul>
		<div class="collapse navbar-collapse order-4 order-md-1">
			<ul class="navbar-nav main-nav me-auto order-5 order-md-2">
				
					
						<li class="nav-item">
							<a class="nav-link" href="https://blog.aloni.org/pages/about/intro/">Pages</a>
						</li>
					
						<li class="nav-item">
							<a class="nav-link" href="https://blog.aloni.org/posts/">Recent</a>
						</li>
					
						<li class="nav-item">
							<a class="nav-link" href="https://blog.aloni.org/archive/">Archive</a>
						</li>
					

				
			</ul>
			<div class="break order-6 d-md-none"></div>
			
		</div>
	</div>
</header>



  
<div class="wrap container" role="document">
  <div class="content">
    <div class="row justify-content-center">
      <div class="col-md-14 col-lg-12 col-xl-10">
        <article>
          <div class="blog-header">
            <h1>Back Propagation with TensorFlow</h1>
            
<p><small>Posted April 26, 2016&nbsp;&hyphen;&nbsp;<strong>5&nbsp;min read</strong></small><p>

          </div>
          
          <p><strong>(Updated for TensorFlow 1.0 on March 6th, 2017)</strong></p>
<p>When I first read about neural network in Michael Nielsen's <span class='external-link-outer'><a class="external-link"rel="noopener" target="_blank" href="http://neuralnetworksanddeeplearning.com/">Neural Networks and Deep Learning<span class='external-link-no-underline'></span><svg width='13.5' height='13.5' aria-hidden='true' viewBox='0 0 24 24' class='iconExternalLink_wgqa'><path fill='currentColor' d='M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z'></path></svg></a></span>, I was excited to find a good source that explains the material along with actual code. However there was a rather steep jump in the part that describes the basic math and the part that goes about implementing it, and it was especially apparent in the  <code>numpy</code>-based code that implements backward propagation.</p>
<span id="continue-reading"></span>
<p>So, in order to explain it better to myself, and learn about <span class='external-link-outer'><a class="external-link"rel="noopener" target="_blank" href="https://www.tensorflow.org/">TensorFlow<span class='external-link-no-underline'></span><svg width='13.5' height='13.5' aria-hidden='true' viewBox='0 0 24 24' class='iconExternalLink_wgqa'><path fill='currentColor' d='M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z'></path></svg></a></span> in the process, I took it upon myself to implement the first network in the book using TensorFlow by two means. First, <em>manually</em> defining the back propagation step, and the second - letting TensorFlow do the hard work using <span class='external-link-outer'><a class="external-link"rel="noopener" target="_blank" href="https://en.wikipedia.org/wiki/Automatic_differentiation">automatic differentiation<span class='external-link-no-underline'></span><svg width='13.5' height='13.5' aria-hidden='true' viewBox='0 0 24 24' class='iconExternalLink_wgqa'><path fill='currentColor' d='M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z'></path></svg></a></span>.</p>
<h2 id="setup">Setup</h2>
<p>First, we need to load TensorFlow and setup the basic parts of the graph - inputs (<code>a_0</code>, <code>y</code>), and states (<code>w_1</code>, <code>b_1</code>, <code>w_2</code>, <code>b_2</code>).</p>
<div class="mycode-block"><table class="codeBox"><tbody><tr><td class="sourceCode sourceCodeWrap"><pre class="code"><span class="source python"><span class="comment line number-sign python"><span class="punctuation definition comment python">#</span>!/usr/bin/env python
</span>
<span class="meta statement import python"><span class="keyword control import python">import</span> <span class="meta qualified-name python"><span class="meta generic-name python">tensorflow</span></span></span>
<span class="meta statement import python"><span class="keyword control import python">import</span> <span class="meta qualified-name python"><span class="meta generic-name python">tensorflow</span></span> <span class="keyword control import as python">as</span> <span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span></span>

<span class="meta statement import python"><span class="keyword control import from python">from</span></span><span class="meta statement import python"><span class="meta import-source python"> <span class="meta import-path python"><span class="meta import-name python">tensorflow</span><span class="punctuation accessor dot python">.</span><span class="meta import-name python">examples</span><span class="punctuation accessor dot python">.</span><span class="meta import-name python">tutorials</span><span class="punctuation accessor dot python">.</span><span class="meta import-name python">mnist</span></span> <span class="meta statement import python"><span class="keyword control import python">import</span></span></span></span><span class="meta statement import python"></span><span class="meta statement import python"> <span class="meta generic-name python">input_data</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">mnist</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">input_data</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">read_data_sets</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta string python"><span class="string quoted double python"><span class="punctuation definition string begin python">&quot;</span></span></span><span class="meta string python"><span class="string quoted double python">MNIST_data/<span class="punctuation definition string end python">&quot;</span></span></span><span class="punctuation separator arguments python">,</span> <span class="variable parameter python">one_hot</span><span class="keyword operator assignment python">=</span><span class="constant language python">True</span><span class="punctuation section arguments end python">)</span></span>

<span class="meta qualified-name python"><span class="meta generic-name python">a_0</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">placeholder</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">tf</span><span class="punctuation accessor dot python">.</span><span class="meta generic-name python">float32</span></span><span class="punctuation separator arguments python">,</span> <span class="meta sequence list python"><span class="punctuation section sequence begin python">[</span><span class="constant language python">None</span><span class="punctuation separator sequence python">,</span> <span class="constant numeric integer decimal python">784</span><span class="punctuation section sequence end python">]</span></span><span class="punctuation section arguments end python">)</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">y</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">placeholder</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">tf</span><span class="punctuation accessor dot python">.</span><span class="meta generic-name python">float32</span></span><span class="punctuation separator arguments python">,</span> <span class="meta sequence list python"><span class="punctuation section sequence begin python">[</span><span class="constant language python">None</span><span class="punctuation separator sequence python">,</span> <span class="constant numeric integer decimal python">10</span><span class="punctuation section sequence end python">]</span></span><span class="punctuation section arguments end python">)</span></span>

<span class="meta qualified-name python"><span class="meta generic-name python">middle</span></span> <span class="keyword operator assignment python">=</span> <span class="constant numeric integer decimal python">30</span>
<span class="meta qualified-name python"><span class="meta generic-name python">w_1</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">Variable</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">truncated_normal</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta sequence list python"><span class="punctuation section sequence begin python">[</span><span class="constant numeric integer decimal python">784</span><span class="punctuation separator sequence python">,</span> <span class="meta qualified-name python"><span class="meta generic-name python">middle</span></span><span class="punctuation section sequence end python">]</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">b_1</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">Variable</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">truncated_normal</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta sequence list python"><span class="punctuation section sequence begin python">[</span><span class="constant numeric integer decimal python">1</span><span class="punctuation separator sequence python">,</span> <span class="meta qualified-name python"><span class="meta generic-name python">middle</span></span><span class="punctuation section sequence end python">]</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">w_2</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">Variable</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">truncated_normal</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta sequence list python"><span class="punctuation section sequence begin python">[</span><span class="meta qualified-name python"><span class="meta generic-name python">middle</span></span><span class="punctuation separator sequence python">,</span> <span class="constant numeric integer decimal python">10</span><span class="punctuation section sequence end python">]</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">b_2</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">Variable</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">truncated_normal</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta sequence list python"><span class="punctuation section sequence begin python">[</span><span class="constant numeric integer decimal python">1</span><span class="punctuation separator sequence python">,</span> <span class="constant numeric integer decimal python">10</span><span class="punctuation section sequence end python">]</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
</span></td></pre></tr></tbody></table></div><h2 id="the-sigmoid-function">The sigmoid function</h2>
<p>Our sigmoid function, although provided by TensorFlow's extensive function library, is brought here as reference:</p>
<p>$$
\sigma(z) = \frac{1}{1+e^{-z}}
$$</p>
<div class="mycode-block"><table class="codeBox"><tbody><tr><td class="sourceCode sourceCodeWrap"><pre class="code"><span class="source python"><span class="meta function python"><span class="storage type function python"><span class="keyword declaration function python">def</span></span> <span class="entity name function python"><span class="meta generic-name python">sigma</span></span></span><span class="meta function parameters python"><span class="punctuation section parameters begin python">(</span></span><span class="meta function parameters python"><span class="variable parameter python">x</span><span class="punctuation section parameters end python">)</span></span><span class="meta function python"><span class="punctuation section function begin python">:</span></span>
    <span class="keyword control flow return python">return</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">div</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">constant</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="constant numeric float decimal python">1<span class="punctuation separator decimal python">.</span>0</span><span class="punctuation section arguments end python">)</span></span><span class="punctuation separator arguments python">,</span>
                  <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">add</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">constant</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="constant numeric float decimal python">1<span class="punctuation separator decimal python">.</span>0</span><span class="punctuation section arguments end python">)</span></span><span class="punctuation separator arguments python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">exp</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">negative</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">x</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
</span></td></pre></tr></tbody></table></div><h2 id="the-forward-propagation">The forward propagation</h2>
<p>Provided that the input image is given by the \( a_0 \) matrix, calculating forward propagation for multiple
images at a time can be done with simple matrix multiplication, defined as such:</p>
<script type="math/tex;mode=display">\begin{aligned}
& z_1 = a_0 \cdot w_1 + b_1 \\
& a_1 = \sigma(z_1) \\
& z_2 = a_1 \cdot w_2 + b_2 \\
& a_2 = \sigma(z_2) \\
\end{aligned}</script>
<p>Given a tensor of <em>multiple images</em>, this can done in TensorFlow for <em>all</em> them at the same time (thanks to 'broadcasting'),
so the above gets a one-to-one translation in TensorFlow:</p>
<div class="mycode-block"><table class="codeBox"><tbody><tr><td class="sourceCode sourceCodeWrap"><pre class="code"><span class="source python"><span class="meta qualified-name python"><span class="meta generic-name python">z_1</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">add</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">matmul</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">a_0</span></span><span class="punctuation separator arguments python">,</span> <span class="meta qualified-name python"><span class="meta generic-name python">w_1</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation separator arguments python">,</span> <span class="meta qualified-name python"><span class="meta generic-name python">b_1</span></span><span class="punctuation section arguments end python">)</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">a_1</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">sigma</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">z_1</span></span><span class="punctuation section arguments end python">)</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">z_2</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">add</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">matmul</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">a_1</span></span><span class="punctuation separator arguments python">,</span> <span class="meta qualified-name python"><span class="meta generic-name python">w_2</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation separator arguments python">,</span> <span class="meta qualified-name python"><span class="meta generic-name python">b_2</span></span><span class="punctuation section arguments end python">)</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">a_2</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">sigma</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">z_2</span></span><span class="punctuation section arguments end python">)</span></span>
</span></td></pre></tr></tbody></table></div><h2 id="difference">Difference</h2>
<p>The input provides \( y \) as the test for the accuracy of the network's output, so we compute the following vector:</p>
<script type="math/tex;mode=display">\begin{aligned}
& \nabla a = a_2 - y \\
\end{aligned}</script>
<div class="mycode-block"><table class="codeBox"><tbody><tr><td class="sourceCode sourceCodeWrap"><pre class="code"><span class="source python"><span class="meta qualified-name python"><span class="meta generic-name python">diff</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">subtract</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">a_2</span></span><span class="punctuation separator arguments python">,</span> <span class="meta qualified-name python"><span class="meta generic-name python">y</span></span><span class="punctuation section arguments end python">)</span></span>
</span></td></pre></tr></tbody></table></div><h2 id="the-sigmoid-prime-function">The sigmoid prime function</h2>
<p>Here's the derivate of the sigmoid function from above, which will be needed during the backward propagation:</p>
<p>$$
\sigma'(z) = \sigma(z)(1 - \sigma(z))
$$</p>
<div class="mycode-block"><table class="codeBox"><tbody><tr><td class="sourceCode sourceCodeWrap"><pre class="code"><span class="source python"><span class="meta function python"><span class="storage type function python"><span class="keyword declaration function python">def</span></span> <span class="entity name function python"><span class="meta generic-name python">sigmaprime</span></span></span><span class="meta function parameters python"><span class="punctuation section parameters begin python">(</span></span><span class="meta function parameters python"><span class="variable parameter python">x</span><span class="punctuation section parameters end python">)</span></span><span class="meta function python"><span class="punctuation section function begin python">:</span></span>
    <span class="keyword control flow return python">return</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">multiply</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">sigma</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">x</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation separator arguments python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">subtract</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">constant</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="constant numeric float decimal python">1<span class="punctuation separator decimal python">.</span>0</span><span class="punctuation section arguments end python">)</span></span><span class="punctuation separator arguments python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">sigma</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">x</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
</span></td></pre></tr></tbody></table></div><h2 id="back">Backward propagation</h2>
<p>The most complicated part is the backward propagation. First, we need to compute the deltas of the weights and biases. In the original book the Python code was a bit puzzling, but here we can describe the same algorithm in a functional, stateless way.</p>
<script type="math/tex;mode=display">\begin{aligned}
& \nabla z_2 = \nabla a \cdot \sigma'(z_2) \\
& \nabla b_2 = \nabla z_2 \\
& \nabla w_2 = a_1^T \cdot \nabla z_2 \\
& \\
& \nabla a_1 = \nabla z_2 \cdot w_2^T \\
& \nabla z_1 = \nabla a_1 \cdot \sigma'(z_1) \\
& \nabla b_1 = \nabla z_1 \\
& \nabla w_1 = a_0^T \cdot \nabla z_1 \\
\end{aligned}</script>
<p>It's also one-to-one with:</p>
<div class="mycode-block"><table class="codeBox"><tbody><tr><td class="sourceCode sourceCodeWrap"><pre class="code"><span class="source python"><span class="meta qualified-name python"><span class="meta generic-name python">d_z_2</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">multiply</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">diff</span></span><span class="punctuation separator arguments python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">sigmaprime</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">z_2</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">d_b_2</span></span> <span class="keyword operator assignment python">=</span> <span class="meta qualified-name python"><span class="meta generic-name python">d_z_2</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">d_w_2</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">matmul</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">transpose</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">a_1</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation separator arguments python">,</span> <span class="meta qualified-name python"><span class="meta generic-name python">d_z_2</span></span><span class="punctuation section arguments end python">)</span></span>

<span class="meta qualified-name python"><span class="meta generic-name python">d_a_1</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">matmul</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">d_z_2</span></span><span class="punctuation separator arguments python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">transpose</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">w_2</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">d_z_1</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">multiply</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">d_a_1</span></span><span class="punctuation separator arguments python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">sigmaprime</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">z_1</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">d_b_1</span></span> <span class="keyword operator assignment python">=</span> <span class="meta qualified-name python"><span class="meta generic-name python">d_z_1</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">d_w_1</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">matmul</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">transpose</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">a_0</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation separator arguments python">,</span> <span class="meta qualified-name python"><span class="meta generic-name python">d_z_1</span></span><span class="punctuation section arguments end python">)</span></span>
</span></td></pre></tr></tbody></table></div><h2 id="upd">Updating the network</h2>
<p>We take the computed \( \nabla \) and update the weights in one step. Note that the following does not precisely match the book - I have omitted the constant \( 1/n \) divider. For simplicity, it's not really needed, as it comes into play inside the \( \eta \) itself, in this case.</p>
<script type="math/tex;mode=display">\begin{aligned}
& w_1 \leftarrow w_1 - \eta \cdot \nabla w_1 \\
& b_1 \leftarrow b_1 - \eta \cdot \nabla b_1 \\
& w_2 \leftarrow w_2 - \eta \cdot \nabla w_2 \\
& b_2 \leftarrow b_2 - \eta \cdot \nabla b_2 \\
\end{aligned}</script>
<p>In TensorFlow, it can translate to a list of a assignments:</p>
<div class="mycode-block"><table class="codeBox"><tbody><tr><td class="sourceCode sourceCodeWrap"><pre class="code"><span class="source python"><span class="meta qualified-name python"><span class="meta generic-name python">eta</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">constant</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="constant numeric float decimal python">0<span class="punctuation separator decimal python">.</span>5</span><span class="punctuation section arguments end python">)</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">step</span></span> <span class="keyword operator assignment python">=</span> <span class="meta sequence list python"><span class="punctuation section sequence begin python">[</span>
    <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">assign</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">w_1</span></span><span class="punctuation separator arguments python">,</span>
            <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">subtract</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">w_1</span></span><span class="punctuation separator arguments python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">multiply</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">eta</span></span><span class="punctuation separator arguments python">,</span> <span class="meta qualified-name python"><span class="meta generic-name python">d_w_1</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
  <span class="punctuation separator sequence python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">assign</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">b_1</span></span><span class="punctuation separator arguments python">,</span>
            <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">subtract</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">b_1</span></span><span class="punctuation separator arguments python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">multiply</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">eta</span></span><span class="punctuation separator arguments python">,</span>
                               <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">reduce_mean</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">d_b_1</span></span><span class="punctuation separator arguments python">,</span> <span class="variable parameter python">axis</span><span class="keyword operator assignment python">=</span><span class="meta sequence list python"><span class="punctuation section sequence begin python">[</span><span class="constant numeric integer decimal python">0</span><span class="punctuation section sequence end python">]</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
  <span class="punctuation separator sequence python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">assign</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">w_2</span></span><span class="punctuation separator arguments python">,</span>
            <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">subtract</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">w_2</span></span><span class="punctuation separator arguments python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">multiply</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">eta</span></span><span class="punctuation separator arguments python">,</span> <span class="meta qualified-name python"><span class="meta generic-name python">d_w_2</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
  <span class="punctuation separator sequence python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">assign</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">b_2</span></span><span class="punctuation separator arguments python">,</span>
            <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">subtract</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">b_2</span></span><span class="punctuation separator arguments python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">multiply</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">eta</span></span><span class="punctuation separator arguments python">,</span>
                               <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">reduce_mean</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">d_b_2</span></span><span class="punctuation separator arguments python">,</span> <span class="variable parameter python">axis</span><span class="keyword operator assignment python">=</span><span class="meta sequence list python"><span class="punctuation section sequence begin python">[</span><span class="constant numeric integer decimal python">0</span><span class="punctuation section sequence end python">]</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
<span class="punctuation section sequence end python">]</span></span>
</span></td></pre></tr></tbody></table></div><h2 id="running-and-testing-the-training-process">Running and testing the training process</h2>
<p>The following will be able to train the network and test it in the meanwhile, using mini-batches of 10. Here, I chose to test with 1000 items from the test set, every 1000 mini-batches.</p>
<div class="mycode-block"><table class="codeBox"><tbody><tr><td class="sourceCode sourceCodeWrap"><pre class="code"><span class="source python"><span class="meta qualified-name python"><span class="meta generic-name python">acct_mat</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">equal</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">argmax</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">a_2</span></span><span class="punctuation separator arguments python">,</span> <span class="constant numeric integer decimal python">1</span><span class="punctuation section arguments end python">)</span></span><span class="punctuation separator arguments python">,</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">argmax</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">y</span></span><span class="punctuation separator arguments python">,</span> <span class="constant numeric integer decimal python">1</span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">acct_res</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">reduce_sum</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">cast</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">acct_mat</span></span><span class="punctuation separator arguments python">,</span> <span class="meta qualified-name python"><span class="meta generic-name python">tf</span><span class="punctuation accessor dot python">.</span><span class="meta generic-name python">float32</span></span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>

<span class="meta qualified-name python"><span class="meta generic-name python">sess</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">InteractiveSession</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="punctuation section arguments end python">)</span></span>
<span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">sess</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">run</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">global_variables_initializer</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="punctuation section arguments end python">)</span></span><span class="punctuation section arguments end python">)</span></span>

<span class="meta statement loop for python"><span class="keyword control loop for python">for</span> <span class="meta generic-name python">i</span> <span class="keyword control loop for in python">in</span></span><span class="meta statement loop for python"> <span class="meta function-call python"><span class="meta qualified-name python"><span class="variable function python"><span class="support type python">xrange</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="constant numeric integer decimal python">10000</span><span class="punctuation section arguments end python">)</span></span></span><span class="meta statement loop for python"><span class="punctuation section block loop for python">:</span></span>
    <span class="meta qualified-name python"><span class="meta generic-name python">batch_xs</span></span>, <span class="meta qualified-name python"><span class="meta generic-name python">batch_ys</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">mnist</span><span class="punctuation accessor dot python">.</span><span class="meta generic-name python">train</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">next_batch</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="constant numeric integer decimal python">10</span><span class="punctuation section arguments end python">)</span></span>
    <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">sess</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">run</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">step</span></span><span class="punctuation separator arguments python">,</span> <span class="variable parameter python">feed_dict</span> <span class="keyword operator assignment python">=</span> <span class="meta mapping python"><span class="punctuation section mapping begin python">{</span></span><span class="meta mapping key python"><span class="meta qualified-name python"><span class="meta generic-name python">a_0</span></span></span><span class="meta mapping python"><span class="punctuation separator mapping key-value python">:</span></span><span class="meta mapping python"> </span><span class="meta mapping value python"><span class="meta qualified-name python"><span class="meta generic-name python">batch_xs</span></span></span><span class="meta mapping python"><span class="punctuation separator mapping python">,</span>
                                <span class="meta mapping key python"><span class="meta qualified-name python"><span class="meta generic-name python">y</span></span> </span><span class="punctuation separator mapping key-value python">:</span></span><span class="meta mapping python"> </span><span class="meta mapping value python"><span class="meta qualified-name python"><span class="meta generic-name python">batch_ys</span></span></span><span class="meta mapping python"><span class="punctuation section mapping end python">}</span></span><span class="punctuation section arguments end python">)</span></span>
    <span class="meta statement conditional if python"><span class="keyword control conditional if python">if</span> <span class="meta qualified-name python"><span class="meta generic-name python">i</span></span> <span class="keyword operator arithmetic python">%</span> <span class="constant numeric integer decimal python">1000</span> <span class="keyword operator comparison python">==</span> <span class="constant numeric integer decimal python">0</span><span class="punctuation section block conditional if python">:</span></span>
        <span class="meta qualified-name python"><span class="meta generic-name python">res</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">sess</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">run</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">acct_res</span></span><span class="punctuation separator arguments python">,</span> <span class="variable parameter python">feed_dict</span> <span class="keyword operator assignment python">=</span>
                       <span class="meta mapping python"><span class="punctuation section mapping begin python">{</span></span><span class="meta mapping key python"><span class="meta qualified-name python"><span class="meta generic-name python">a_0</span></span></span><span class="meta mapping python"><span class="punctuation separator mapping key-value python">:</span></span><span class="meta mapping python"> </span><span class="meta mapping value python"><span class="meta item-access python"><span class="meta qualified-name python"><span class="meta generic-name python">mnist</span><span class="punctuation accessor dot python">.</span><span class="meta generic-name python">test</span><span class="punctuation accessor dot python">.</span><span class="meta generic-name python">images</span></span></span><span class="meta item-access python"><span class="punctuation section brackets begin python">[</span></span><span class="meta item-access arguments python"><span class="punctuation separator slice python">:</span><span class="constant numeric integer decimal python">1000</span></span><span class="meta item-access python"><span class="punctuation section brackets end python">]</span></span></span><span class="meta mapping python"><span class="punctuation separator mapping python">,</span>
                        <span class="meta mapping key python"><span class="meta qualified-name python"><span class="meta generic-name python">y</span></span> </span><span class="punctuation separator mapping key-value python">:</span></span><span class="meta mapping python"> </span><span class="meta mapping value python"><span class="meta item-access python"><span class="meta qualified-name python"><span class="meta generic-name python">mnist</span><span class="punctuation accessor dot python">.</span><span class="meta generic-name python">test</span><span class="punctuation accessor dot python">.</span><span class="meta generic-name python">labels</span></span></span><span class="meta item-access python"><span class="punctuation section brackets begin python">[</span></span><span class="meta item-access arguments python"><span class="punctuation separator slice python">:</span><span class="constant numeric integer decimal python">1000</span></span><span class="meta item-access python"><span class="punctuation section brackets end python">]</span></span></span><span class="meta mapping python"><span class="punctuation section mapping end python">}</span></span><span class="punctuation section arguments end python">)</span></span>
        <span class="keyword other print python">print</span> <span class="meta qualified-name python"><span class="meta generic-name python">res</span></span>
</span></td></pre></tr></tbody></table></div>
<p>Running it shows that it manages to train the network, as we quickly get 923 correct out of 1000 tests.</p>
<div class="mycode-block"><table class="codeBox"><tbody><tr><td class="sourceCode sourceCodeWrap"><pre class="code"><span class="text plain">Extracting MNIST_data/train-images-idx3-ubyte.gz
Extracting MNIST_data/train-labels-idx1-ubyte.gz
Extracting MNIST_data/t10k-images-idx3-ubyte.gz
Extracting MNIST_data/t10k-labels-idx1-ubyte.gz
93.0
741.0
870.0
909.0
904.0
912.0
916.0
923.0
</span></td></pre></tr></tbody></table></div><h2 id="automatic-differentiation">Automatic differentiation</h2>
<p>The great part about TensorFlow is its ability to derive the step function on its own. So, instead of the rather complicated 'Backward propagation' and 'Updating the network' given above for educational purposes (see: <a href="https://blog.aloni.org/posts/backprop-with-tensorflow/#back">backward propagation</a> and <a href="https://blog.aloni.org/posts/backprop-with-tensorflow/#upd">updating</a>), we can simply write the following step function alternative:</p>
<div class="mycode-block"><table class="codeBox"><tbody><tr><td class="sourceCode sourceCodeWrap"><pre class="code"><span class="source python"><span class="meta qualified-name python"><span class="meta generic-name python">cost</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">multiply</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">diff</span></span><span class="punctuation separator arguments python">,</span> <span class="meta qualified-name python"><span class="meta generic-name python">diff</span></span><span class="punctuation section arguments end python">)</span></span>
<span class="meta qualified-name python"><span class="meta generic-name python">step</span></span> <span class="keyword operator assignment python">=</span> <span class="meta function-call python"><span class="meta qualified-name python"><span class="meta generic-name python">tf</span><span class="punctuation accessor dot python">.</span><span class="meta generic-name python">train</span></span><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">GradientDescentOptimizer</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="constant numeric float decimal python">0<span class="punctuation separator decimal python">.</span>1</span><span class="punctuation section arguments end python">)</span></span><span class="meta function-call python"><span class="meta qualified-name python"><span class="punctuation accessor dot python">.</span></span><span class="meta qualified-name python"><span class="variable function python"><span class="meta generic-name python">minimize</span></span></span></span><span class="meta function-call arguments python"><span class="punctuation section arguments begin python">(</span><span class="meta qualified-name python"><span class="meta generic-name python">cost</span></span><span class="punctuation section arguments end python">)</span></span>
</span></td></pre></tr></tbody></table></div>
<p>And observe that the training still works.</p>

        </article>
	<div>
	    <hr />
	    <div class="footerIcons">
		<span class="footerChild1">
		    <h6 class="SocialShare_socialShareTitle">Share this post</h6>
		    <ul class="SocialShare_socialIcons">
			<li>
			    <a title="Tweet" target="_blank" rel="noopener noreferrer" href="https://twitter.com/intent/tweet?text=Back%20Propagation%20with%20TensorFlow&amp;url=https:&#x2F;&#x2F;blog.aloni.org&#x2F;posts&#x2F;backprop-with-tensorflow&#x2F; by @DanAloni"
				class="SocialShare_socialIconButton" style="--socialIconColor:var(--colorTwitter)">
				<svg xmlns="http://www.w3.org/2000/svg"
				    viewBox="0 0 512 512" class="twitter_svg__svg-inline--fa twitter_svg__fa-w-14"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z">
				</path></svg>
			    </a>
			</li>
			<li><a title="Share on Linkedin" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/sharing/share-offsite/?url=https:&#x2F;&#x2F;blog.aloni.org&#x2F;posts&#x2F;backprop-with-tensorflow&#x2F;" class="SocialShare_socialIconButton" style="--socialIconColor:var(--colorLinkedIn)">
				<svg aria-hidden="true" data-prefix="fab" data-icon="linkedin-in" class="linkedin_svg__svg-inline--fa linkedin_svg__fa-linkedin-in linkedin_svg__fa-w-14" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
				    <path fill="currentColor" d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 01107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z">
				    </path>
				</svg></a>
			</li>
			<li id="aloni-copy-link">
			    <span tabindex="0" title="Copy post link" class="SocialShare_socialIconButton" style="--socialIconColor:var(--colorNeutral900)"><svg aria-hidden="true" data-prefix="far" data-icon="link" class="link_svg__svg-inline--fa link_svg__fa-link link_svg__fa-w-16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
				    <path fill="currentColor" d="M314.222 197.78c51.091 51.091 54.377 132.287 9.75 187.16-6.242 7.73-2.784 3.865-84.94 86.02-54.696 54.696-143.266 54.745-197.99 0-54.711-54.69-54.734-143.255 0-197.99 32.773-32.773 51.835-51.899 63.409-63.457 7.463-7.452 20.331-2.354 20.486 8.192a173.31 173.31 0 004.746 37.828c.966 4.029-.272 8.269-3.202 11.198L80.632 312.57c-32.755 32.775-32.887 85.892 0 118.8 32.775 32.755 85.892 32.887 118.8 0l75.19-75.2c32.718-32.725 32.777-86.013 0-118.79a83.722 83.722 0 00-22.814-16.229c-4.623-2.233-7.182-7.25-6.561-12.346 1.356-11.122 6.296-21.885 14.815-30.405l4.375-4.375c3.625-3.626 9.177-4.594 13.76-2.294 12.999 6.524 25.187 15.211 36.025 26.049zM470.958 41.04c-54.724-54.745-143.294-54.696-197.99 0-82.156 82.156-78.698 78.29-84.94 86.02-44.627 54.873-41.341 136.069 9.75 187.16 10.838 10.838 23.026 19.525 36.025 26.049 4.582 2.3 10.134 1.331 13.76-2.294l4.375-4.375c8.52-8.519 13.459-19.283 14.815-30.405.621-5.096-1.938-10.113-6.561-12.346a83.706 83.706 0 01-22.814-16.229c-32.777-32.777-32.718-86.065 0-118.79l75.19-75.2c32.908-32.887 86.025-32.755 118.8 0 32.887 32.908 32.755 86.025 0 118.8l-45.848 45.84c-2.93 2.929-4.168 7.169-3.202 11.198a173.31 173.31 0 014.746 37.828c.155 10.546 13.023 15.644 20.486 8.192 11.574-11.558 30.636-30.684 63.409-63.457 54.733-54.735 54.71-143.3-.001-197.991z">
				    </path>
				</svg>
			    </span>
			</li>
		    </ul>
		</span>
		
		<span class="footerChild2">
		    <h6 class="SocialShare_socialShareTitle">Follow author</h6>
		    <ul class="SocialShare_socialIcons">
			<li>
			    <a href="https://twitter.com/DanAloni?ref_src=twsrc%5Etfw" data-dnt="true" data-show-count="false" data-show-screen-name="false" class="SocialShare_socialIconButton twitter-follow-button" style="--socialIconColor:var(--colorTwitter)">
				<svg xmlns="http://www.w3.org/2000/svg"
				    viewBox="0 0 512 512" class="twitter_svg__svg-inline--fa twitter_svg__fa-w-14"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z">
				</path></svg>
			    </a>
			    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
			</li>
		    </ul>
		</span>
		
	    </div>
	</div>
      </div>
    </div>
  </div>
</div>


  
    
<footer class="footer text-muted">
	<div class="container">
		<div class="row">
			<div class="col-lg-8 order-last order-lg-first">
				<ul class="list-inline">
					
						<li class="list-inline-item">Powered by a customized <a href="https://www.getzola.org/">Zola</a>, with a <a href="https://github.com/aaranxu/adidoks">AdiDoks</a> theme</li>
					
				</ul>
			</div>
			<div class="col-lg-8 order-first order-lg-last text-lg-end">
				<ul class="list-inline">
					
				</ul>
			</div>
		</div>
	</div>
</footer>

  

  
<script src="https://blog.aloni.org/js/main.js" defer></script>


</body>
</html>
